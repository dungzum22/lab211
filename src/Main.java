import java.io.IOException;
import java.util.Scanner;

public class Main {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
//        String excelFilePath = "D:\\FPT SE 3\\CSD201\\data.xlsx";
//        Graph graph = null;
//
//        try {
//            graph = Graph.readFromExcel(excelFilePath);
//        } catch (IOException e) {
//            System.out.println("Đọc file Excel không thành công: " + e.getMessage());
//            return;
//        }
        double[][] distances = {
                {0, 4, 5, 9999, 9999, 1, 9999, 9999, 9999, 9999, 9999, 9999, 1.5, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 4.2, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999},
                {4.1, 0, 1.2, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 2.6, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 17, 9999, 2.7, 9999, 9999, 9999, 9999, 9999, 9999, 9999},
                {5.3, 1.2, 0, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 3.3, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 3.8, 9999, 9999, 9999, 9999, 9999},
                {9999, 9999, 9999, 0, 9999, 9999, 9999, 9999, 7.6, 9999, 9999, 9999, 9999, 5.1, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 1.7, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 1.7, 9999, 9999, 9999},
                {9999, 9999, 9999, 9999, 0, 9999, 9999, 10.4, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999},
                {1.6, 9999, 9999, 9999, 9999, 0, 9999, 7.8, 9999, 9999, 9999, 1.9, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999},
                {9999, 9999, 9999, 9999, 9999, 9999, 0, 9999, 11, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 4.9, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999},
                {9999, 9999, 9999, 9999, 10.4, 7.8, 9999, 0, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 32.4, 9999, 9999, 9999, 9999, 9999, 26.3, 9999, 6.5},
                {9999, 9999, 9999, 7.6, 9999, 9999, 11, 9999, 0, 9999, 9999, 9999, 9999, 1.1, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999},
                {9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 0, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 10.2, 9999, 9999, 12.1, 9999, 17.6, 9999, 9999, 9999, 9999, 9999, 9999, 9.1, 9999, 9999},
                {9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 0, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 5.6, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 5.7, 9999, 9999},
                {9999, 9999, 9999, 9999, 9999, 1.9, 9999, 9999, 9999, 9999, 9999, 0, 9999, 9999, 9999, 9999, 9999, 4.8, 9999, 9999, 9999, 9999, 9999, 9999, 3.8, 9999, 9999, 9999, 9.1, 9999, 9999, 9999, 9999},
                {1.5, 2.6, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 0, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 2.5, 9999, 9999, 1.2, 9999, 9999, 9999, 9999},
                {9999, 9999, 9999, 5.1, 9999, 9999, 9999, 9999, 1.1, 9999, 9999, 9999, 9999, 0, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 6.1, 9999, 2.8, 9999},
                {9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 0, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 4.1, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999},
                {9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 0, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999},
                {9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 0, 9999, 9999, 9999, 9999, 9999, 9999, 3.3, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999},
                {9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 0, 9999, 2.2, 9999, 0.8, 9999, 9999, 3.3, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999},
                {9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 0, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 11.4, 9999, 9999, 9999, 9999, 8.4, 9999},
                {9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 0, 9999, 4.1, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999},
                {9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 0, 9999, 4.2, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999},
                {9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 0, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999},
                {9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 4.1, 9999, 0, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999},
                {9999, 9999, 9999, 9999, 1.7, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 1, 9999, 9999, 9999, 9999, 9999, 9999},
                {9999, 17, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 17.6, 9999, 9999, 9999, 9999, 4.1, 9.7, 3.3, 9999, 9999, 9999, 9999, 9999, 9999, 0, 4.4, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999},
                {4.2, 9999, 9999, 9999, 9999, 9999, 9999, 32.4, 9999, 9999, 9999, 3.8, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 4.4, 0, 9999, 1, 9999, 9999, 9999, 9999, 9999, 9999},
                {9999, 2.7, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 2.5, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 0, 9999, 1, 9999, 9999, 9999, 9999, 9999},
                {9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 11.4, 9999, 9999, 9999, 9999, 1, 9999, 0, 9999, 9999, 9999, 9999, 9999},
                {9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 5.4, 9999, 9999, 9999, 1, 9999, 0, 9999, 1.9, 9999, 9999, 9999},
                {9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 1, 9999, 9999, 9999, 9999, 1.9, 9999, 0, 9999, 9999, 9999},
                {9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 13, 9999},
                {9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 0}};


        Graph graph = new Graph(distances);
        int choice;
        do {
            displayMenu();
            choice = scanner.nextInt();
            handleChoice(graph, choice, scanner);
        } while (choice != 0);

        scanner.close();
    }

    private static void displayMenu() {
        System.out.println("\nChọn thuật toán:");
        System.out.println("1. Thuật toán Dijkstra");
        System.out.println("2. Thuật toán Prim");
        System.out.println("3. Thuật toán Kruskal");
        System.out.println("0. Thoát");
        System.out.print("Nhập lựa chọn của bạn: ");
    }

    private static void handleChoice(Graph graph, int choice, Scanner scanner) {
        switch (choice) {
            case 1:
                System.out.print("Nhập đỉnh nguồn cho thuật toán Dijkstra: ");
                int source = scanner.nextInt();
                graph.dijkstra(source);
                break;
            case 2:
                graph.prim();
                break;
            case 3:
                graph.kruskal();
                break;
            case 0:
                System.out.println("Thoát chương trình.");
                break;
            default:
                System.out.println("Lựa chọn không hợp lệ.");
                break;
        }
    }
}